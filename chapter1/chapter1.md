# 1장 소프트웨어 변경

## 소프트웨어 코드를 변경하는 네 가지 이유

소프트웨어 코드를 변경하는 이유
1. 새로운 기능 추가
2. 버그 수정
3. 설계 개선
4. 자원 이용의 최적화 

### 기능 추가와 버그 수정

현재 소프트웨어가 제공하는 기능외에 사용자가 또 다른 기능을 요구할 때 소프트웨어를 변경하게 된다. 

버그 수정과 기능추가는 고객/기획자/개발자 관점에 따라서 달라진다. 하지만 중요한 것은 동작 변경이 있는지의 여부이다. 

프로그래머의 관점에서는 기존 코드를 변경해야 한다면 **동작 변경**으로 간주하고, 새로운 코드를 추가하고 이를 호출할 뿐이라면 **동작 추가**로 간주하는 것이다. 

### 설계 개선

많은 프로그래머들이 설계 개선을 자주 시도하지 않는 주요 이유 중 하나가 이 과정에서 특정 동작이 누락되거나 원치 않는 동작이 만들어지기 쉽기 때문이다. 

동작 변경없이 설계를 개선하는 행위를 리팩토링이라고 한다. 

리팩토링은 기존 동작이 변경되지 않았음을 확인하는 테스트를 작성하고, 이를 검증하면서 단계별로 작업 진행을 해서 소프트웨어 유지 보수성을 개선할 수 있다는 개념을 기초로 한다. 

변경 관점에서 리팩토링을 할 때 가장 중요한 것은 리팩토링 전후에 기능상의 변경이 없어야 한다는 점이다. 


### 최적화

최적화는 프로그램이 사용하는 시간, 메모리 등의 자원을 변경하면서 기존의 기능은 모두 동일하게 유지한다.

### 네 가지 이유의 종합

일반적으로 시스테에서 작업을 할때 3가지 서로 다르 ㄴ것이 변경될 수 있다.
- **구조** 
- **기능**
- **자원 사용량**

||기능 추가|버그 수정|리팩토링|최적화|
|--|--|--|--|--|
|구조|변경|변경|변경|-|
|새로운 기능|변경|-|-|-|
|기능|-|변경|-|-|
|자원 사용량|-|-|-|변경|

기능 추가, 리팩토링, 최적화는 모두 기존 기능을 그대로 유지한다. 

기능 추가와 버그 수정의 관계는 리팩토링과 최적화의 관계와 매우 비슷하다. 내 가지 경우 모두 일부 기능과 동작에 변경이 일어나지만, 그대로 유지되는 부분이 더 큰 비중을 차지한다. 

문제가 되는 점은 코드를 변경할 때 어떤 동작에 영향을 미칠지 파악하기가 매우 어렵다는 점이다. 안전한 변경을 수행하기 위해서는 영향이 미치는 범위를 정확히 이해하는 것이 가장 중요하다. 

> 기존 동작의 유지는 소프트웨어 개발에서 가장 어려운 문제에 속한다. 주요 기능을 변경해야 할 때조차도 기존 동작의 대부분을 그대로 유지해야 할 때가 많다. 


## 위험한 변경

코드를 변경하면서 동작을 유지할 때 위험이 수반된다. 
위험을 최소화 하기 위한 3가지 질문

1. 어떤 변경을 해야 하는가?
2. 변경이 정확하ㅔㄱ 이뤄졌는지 어떻게 확인할 수 있는가?
3. 무언가를 손상시키지 않았는지 어떻게 확인할 수 있는가? 

메소드를 생성하지 않음으로써 문제를 최소화할 수 있다고 생각하기 쉽다. 하지만 이렇게 되면 기존 클래스와 메소드는 갈수록 비대해져서 결국 코드를 이해하기 어려운 지경에 이른다. 

변경을 자주 하지 않으면 개발자의 실력이 녹슬기 쉽다. 거대한 클래스를 분할하는 작업을 꾸준히 하지 않으면 나중에는 감당하기 힘든 수준이 된다. 꾸준히 수행할수록 점점 더 잘 판단할 수 있게 된다.

변경 회피의 마지막 문제점은 두려움이다. 소프트웨어 변경을 크게 두려워하며 그 두려움은 나날이 커진다. 